<!DOCTYPE html>
<html>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!--声明视窗为设备宽度，兼容移动端设备-->
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>防抖、节流方法的实现</title>
<link rel="stylesheet" href="../../assets/css/index.css" type="text/css" />
<!-- <script src="./other/lodash.js"></script> -->
<style type="text/css">
</style>
<script type="text/javascript">
  
  function debounce(func, wait, immediate) {
    // 使用闭包，防止timerId被污染，并且可记录timerId未丢失
    var timerId,
      _args,
      _that;

    if (typeof func != 'function') {
      throw new TypeError(FUNC_ERROR_TEXT);
    }
    wait = Number(wait) || 0;
    if(immediate===undefined) immediate=false;

    function invokeFunc(time) {
      func.apply(_that, _args);
      timerId=null;
      _args=_that = null;
    }

    function debounced() {
      _args = arguments;
      _that = this;

      if(timerId){
        clearTimeout(timerId);
        timerId = setTimeout(invokeFunc, wait);
        return;
      }
      timerId = setTimeout(invokeFunc, wait);
    }
    return debounced;
  }

  window.onload = function(){
    var fdinput = document.getElementById('fangdou');
    fdinput.addEventListener('keyup', debounce(()=>{
      console.log("123");
    }, 500));
  }

  //
  //window.addEventListener("resize", debounce(()=> console.log("123"), 2000));
</script>
<body ontouchstart>
  <div>
    <div class="fcc-header">
      <div class="content">
        <nav>
          <div class="sites-logo">
            <h1 class="site-title">
              <a href="../../index.html" title="CF CHEN" rel="home">CF CHEN</a>
            </h1>
            <p class="site-description">技术，前端，分享</p>
          </div>
        </nav>
      </div>
    </div>
    <div class="fcc-content content">
      <div style="margin:10px">
        <p><strong>防抖</strong></p>
        <p>1，在闭包内部定义一个随时可以访问的变量timeId，在闭包内部定义可防止变量被全局污染，以及timeId可以保存防抖延迟执行的定时器</p>
        <p>2，利用定时器setTimeout延迟执行的属性，判断定时器是否存在，存在清除掉，重新设置定时器</p>
        <p>
<pre>
function debounce(func, wait, immediate) {
  // 使用闭包，防止timerId被污染，并且可记录timerId未丢失
  var timerId,  _args, _that;

  if (typeof func != 'function') {
    throw new TypeError(FUNC_ERROR_TEXT);
  }
  wait = Number(wait) || 0;
  if(immediate===undefined) immediate=false;

  function invokeFunc(time) {
    func.apply(_that, _args);
    timerId=null;
    _args=_that = null;
  }

  function debounced() {
    _args = arguments;
    _that = this;

    if(timerId){
      clearTimeout(timerId);
      timerId = setTimeout(invokeFunc, wait);
      return;
    }
    timerId = setTimeout(invokeFunc, wait);
  }
  return debounced;
}
</pre>
        </p>
        <div class="fcc-input-group">
          <label>请输入内容查看防抖</label>
          <input type="text" class="fcc-input" id="fangdou" />
        </div>
        <div></div>
        <input type="button" id="sendemail" value="发送">
      </div>
    </div>
  </div>
</body>
</html>